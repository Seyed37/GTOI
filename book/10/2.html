

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="fa" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="fa" > <!--<![endif]-->
<html dir="rtl" lang="fa">
    <head>
        
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">


    
         <title>راه حل O(n+q*lg(n)) به کمک جداسازی سبک-سنگین &mdash; نظریه گراف‌ها برای المپیاد کامپیوتر</title>
    




    

    <link rel="stylesheet" type=text/css href="/_static/main.css">



<link rel="stylesheet" type=text/css href="../../_static/font-awesome.min.css">
<link rel="stylesheet" type=text/css href="../../_static/bootstrap.min.css">
<link rel="stylesheet" type=text/css href="../../_static/pygment-solarized-light.css">


    <link rel="stylesheet" type=text/css href="../../_static/minoo-rtl.css">

        <link rel="index" title="فهرست" href="../../genindex.html" />
        <link rel="search" title="جستجو" href="../../search.html" />
        <link rel="top" title="نظریه گراف‌ها برای المپیاد کامپیوتر" href="../../index.html" />
        <link rel="up" title="Lca" href="index.html" />
        <link rel="next" title="tarjan offline algorithm" href="3.html" />
        <link rel="prev" title="شرح مساله" href="1.html" />



    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>

    
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script type="text/javascript" src="../../_static/translations.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/javascript" src="../../_static/searchtools.js"></script>


<script type="text/javascript" src="../../_static/minoo.js"></script>
<script type="text/javascript" src="../../_static/modernizr.min.js"></script>
    </head>
    <body>
        <div id="page">
            <div id="wrapper-page-sidebar">
                

<div id="page-sidebar">
<div id="sidebar-top">
    <div id="sidebar-top-image">
        <span style="background-image: url('../../_static/avatar.png');"></span>
    </div>
    <div id="sidebar-top-links">
        
            <a href=http://git.coderz.ir target="_blank"><i class="fa fa-globe" style="font-size:23px;"></i></a>
        
        
        
        
        
        
            <a href=https://github.com/dariubs/git target="_blank"><i class="fa fa-github-square" style="font-size:23px;"></i></a>
        
        
    </div>
    <div id="sidebar-navigation">
        <span id="navigation-toggle"><i class="fa  fa-angle-double-left " id="sidebar-toggle-icon" style="font-size: 27px;"></i></span>
        <span id="navigation-search">
                <form action="../../search.html" method="get">
                    <input id="input-search" type="text" name="q"  placeholder="جستجو">
                    <input type="hidden" name="check_keywords" value="yes" />
                    <input type="hidden" name="area" value="default" />
                </form>
        </span>
    </div>
    <div id="sidebar-top-title">
        <a href="../../index.html">نظریه گراف‌ها برای المپیاد کامپیوتر</a>
    </div>
</div>

<div id="wrapper-sidebar-bottom">
<div id="sidebar-bottom">
    <div id="sidebar-bottom-list">
        
        
            <div id="tree-toc">
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../1/index.html">تعاریف اولیه</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../1/1.html">مقدمات و پیاده سازی گراف</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1/2.html">مدل سازی با گراف</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1/3.html">همبندی، یال برشی و راس برشی</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1/4.html">گراف دو بخشی</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1/5.html">گشت، گذر، مسیر، اکسترمال</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../2/index.html">پیمایش گراف</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../2/1.html">درخت چیست؟</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2/2.html">جستجوی عمق اول</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2/3.html">جستجوی سطح اول</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../3/index.html">گراف جهت‌دار</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../3/1.html">تعاریف</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3/2.html">تورنومنت</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3/3.html">مولفه‌های قویا همبند</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3/4.html">بازی‌ها و گراف جهت‌دار</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3/5.html">گراف جهت‌دار بدون دور</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3/6.html">الگوریتم مسیر خاکستری</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3/7.html">گراف تابعی و گراف جایگشت</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../4/index.html">آشنایی با درخت‌ها</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../4/1.html">خاصیت‌های مقدماتی</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4/2.html">فاصله در درخت و گراف</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4/3.html">مرکز و قطر گراف</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4/4.html">شمردن تعداد درخت‌ها</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4/5.html">پیدا کردن قطر درخت</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4/6.html">درخت bfs, dfs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4/7.html">پیدا کردن راس و یال برشی</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../5/index.html">تور اویلری و دور همیلتونی</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../5/1.html">معرفی</a></li>
<li class="toctree-l2"><a class="reference internal" href="../5/2.html">تور اویلری در گراف جهت دار و بی جهت</a></li>
<li class="toctree-l2"><a class="reference internal" href="../5/3.html">De Bruijn sequence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../5/4.html">قضیه های وجودی دور همیلتونی</a></li>
<li class="toctree-l2"><a class="reference internal" href="../5/5.html">الگوریتم های نمایی پیدا کردن دور و مسیر همیلتونی</a></li>
<li class="toctree-l2"><a class="reference internal" href="../5/6.html">اسب شطرنج</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../6/index.html">الگوریتم های کوتاه ترین مسیر</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../6/1.html">بلمن فورد</a></li>
<li class="toctree-l2"><a class="reference internal" href="../6/2.html">دکسترا</a></li>
<li class="toctree-l2"><a class="reference internal" href="../6/3.html">فلوید وارشال</a></li>
<li class="toctree-l2"><a class="reference internal" href="../6/4.html">پیدا کردن دور منفی در گراف</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../7/index.html">ماتریس ها</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../7/1.html">ماتریس مجاورت</a></li>
<li class="toctree-l2"><a class="reference internal" href="../7/2.html">تعداد مسیر ها به طول n</a></li>
<li class="toctree-l2"><a class="reference internal" href="../7/3.html">به دست آوردن توابع بازگشتی به کمک گراف و ماتریس</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../8/index.html">داده ساختار های درختی</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../8/1.html">BST</a></li>
<li class="toctree-l2"><a class="reference internal" href="../8/2.html">heap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../8/3.html">DSU</a></li>
<li class="toctree-l2"><a class="reference internal" href="../8/4.html">Segment tree</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../9/index.html">MST</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../9/1.html">Kruskal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../9/2.html">Prim</a></li>
<li class="toctree-l2"><a class="reference internal" href="../9/3.html">Buvrika</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Lca</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="1.html">شرح مساله</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">راه حل O(n+q*lg(n)) به کمک جداسازی سبک-سنگین</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.html">tarjan offline algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="4.html">تور اویلری درخت و Lca سریع</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../11/index.html">الگوریتم های پیشرفته درخت</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../11/1.html">سنتروید</a></li>
<li class="toctree-l2"><a class="reference internal" href="../11/2.html">گونی</a></li>
<li class="toctree-l2"><a class="reference internal" href="../11/3.html">اچ ال دی</a></li>
<li class="toctree-l2"><a class="reference internal" href="../11/4.html">هافمن کدینگ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../11/5.html">هش درخت</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../12/index.html">تطابق</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../12/1.html">قضایای مینماکس</a></li>
<li class="toctree-l2"><a class="reference internal" href="../12/2.html">الگوریتم ها</a></li>
<li class="toctree-l2"><a class="reference internal" href="../12/3.html">تطابق در گراف های عام</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../13/index.html">همبندی</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../13/1.html">برش ها و همبندی</a></li>
<li class="toctree-l2"><a class="reference internal" href="../13/2.html">گراف k همبند</a></li>
<li class="toctree-l2"><a class="reference internal" href="../13/3.html">فلو</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../14/index.html">مباحث ویژه</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../14/1.html">گراف مسطح</a></li>
<li class="toctree-l2"><a class="reference internal" href="../14/2.html">دنباله درجه ای</a></li>
<li class="toctree-l2"><a class="reference internal" href="../14/3.html">رنگ آمیزی</a></li>
<li class="toctree-l2"><a class="reference internal" href="../14/4.html">یک ریختی</a></li>
<li class="toctree-l2"><a class="reference internal" href="../14/5.html">Random Walk</a></li>
<li class="toctree-l2"><a class="reference internal" href="../14/6.html">اعداد رمزی</a></li>
<li class="toctree-l2"><a class="reference internal" href="../14/7.html">چند جمله ای گراف</a></li>
<li class="toctree-l2"><a class="reference internal" href="../14/8.html">مجموعه مستقل و خوشه</a></li>
<li class="toctree-l2"><a class="reference internal" href="../14/9.html">2sat</a></li>
</ul>
</li>
</ul>

            </div>
        
   </div>
   <div id="sidebar-bottom-versions">
      

   </div>
</div>
</div>
</div>
            </div>
            <div id="page-body">
                <div class="container-fluid">
                        <div id="body-content" style="max-width: 800px">

                            <div class="row-fluid">
			        <div class="col-lg-12">
				    

<div id="body-top">
    
    
        <a href="../../index.html"><i class="fa fa-folder-o"></i>&nbsp; فهرست</a>&nbsp;
        <a><i class="fa  fa-angle-left"></i></a>&nbsp;
        <a><i class="fa fa-folder-open-o"></i>&nbsp; راه حل O(n+q*lg(n)) به کمک جداسازی سبک-سنگین</a>
    
    
        <a style="float: left; padding-right: 20px;" href="/problems/" id="problems-link"><i class="fa fa-question on fa-circle"></i>&nbsp;سوالات</a>
        
            <a href="../../_sources/book/10/2.rst.txt" rel="nofollow" id="top-src" target="_blank"><i class="fa fa-code"></i>&nbsp; سورس</a>
        
    
</div>
			        </div>
			    </div>
                            
                            <div class="row-fluid">
			        <div class="col-lg-12">
				    
  <div class="section" id="o-n-q-lg-n">
<h1>راه حل O(n+q*lg(n)) به کمک جداسازی سبک-سنگین<a class="headerlink" href="#o-n-q-lg-n" title="لینک ثابت به این سر مقاله">¶</a></h1>
<p>در این بخش برای مساله‌های گفته شده یک راه حل
<span class="math notranslate nohighlight">\(O(n+q*lg(n))\)</span>
را بیان می‌کنیم.</p>
<div class="section" id="id1">
<h2>جداسازی سبک-سنگین<a class="headerlink" href="#id1" title="لینک ثابت به این سر مقاله">¶</a></h2>
<p>این جداسازی یک جداسازی پرکاربرد در درخت هاست. این جداسازی یال‌های
درخت را به دو دسته <strong>سبک</strong> و <strong>سنگین</strong> تقسیم می کند.
یال های سنگین یال هایی هستند که اندازه زیردرخت فرزند مربوط به آن از یال های
فرزند های دیگر بیشتر است. تنها یک فرزند می‌تواند یال سنگین داشته باشد و اگر
چند فرزند ماکسیمم بودند، یال یکی را به دلخواه به عنوان سنگین انتخاب می‌کنیم.</p>
<div class="section" id="id2">
<h3>تعداد یال های سبک در مسیر به ریشه<a class="headerlink" href="#id2" title="لینک ثابت به این سر مقاله">¶</a></h3>
<p>تعداد یال‌های سبک در مسیر هر راس به ریشه، حداکثر
<span class="math notranslate nohighlight">\(O(lg(n))\)</span>
است. (چرا؟)</p>
</div>
</div>
<div class="section" id="id3">
<h2>حل مساله اول<a class="headerlink" href="#id3" title="لینک ثابت به این سر مقاله">¶</a></h2>
<p>حداکثر یک فرزند یک راس می تواند سنگین باشد پس می توانیم در
DFS
اول به سراغ راس با یال سنگین برویم تا زمان ورود فرزند سنگین دقیقا یک واحد بیشتر از
پدرش باشد. به این ترتیب اگر راس ها را بر اساس زمان ورود مرتب کنیم، هر کس که یال
به پدرش سنگین است، دقیقا بعد پدرش قرار می‌گیرد.</p>
<p>این ترتیب را به دست بیاورید و هم‌چنین برای هر راس به دست بیاورید چند پدرش
دقیقا به ترتیب پشت سرش قرار گرفته‌اند یا به عبارت دیگر به دست بیاورید که
اولین یال سبک در مسیر این راس به ریشه متعلق به کدام راس است.</p>
<p>حال برای اینکه جد یک راس در ارتفاع خاصی را به دست بیاوریم، اگر تعداد پدر هایی
که پشت این راس آمده اند از ارتفاع مطلوب بیشتر باشد، یا به عبارت دیگر همه یال ها
به جد مطلوب، یال سنگین باشند. در این حالت می‌توانیم در زمان
<span class="math notranslate nohighlight">\(O(1)\)</span>
جد مطلوب را به دست بیاوریم. اما اگر یال سبکی این وسط بود باید به جدی که یال به پدرش سبک
است برویم، سپس پدر آن را بدست آوریم و از آن پدر کار را ادامه دهیم. چون حداکثر
<span class="math notranslate nohighlight">\(O(lg(n))\)</span>
یال سبک در مسیر هر راس به ریشه وجود دارد، این کار در نهایت
<span class="math notranslate nohighlight">\(O(lg(n))\)</span>
به ازای هر پرسش طول می‌کشد و بنابراین پیچیدگی زمانی کل،
<span class="math notranslate nohighlight">\(O(n+q*lg(n))\)</span>
است.</p>
</div>
<div class="section" id="id4">
<h2>حل مساله دوم<a class="headerlink" href="#id4" title="لینک ثابت به این سر مقاله">¶</a></h2>
<p>طبق چیزی که در قسمت قبل گفتیم با راه بالا می توان یک راه
<span class="math notranslate nohighlight">\(O(n+q*lg^2(n))\)</span>
برای مساله پایین ترین جد مشترک ارائه داد. اما به سادگی می‌توانیم راه حل را بهینه‌تر
کنیم. پایین ترین جد مشترک را در نظر بگیرید. مسیر یکی از راس ها به این راس یالش
حتما سبک است
(هر دو یال نمی‌توانند سنگین باشند)
بنابراین با الگوریتم زیر می توانیم پایین ترین جد مشترک را پیدا کنیم.
بدست بیاورید که یال سبک کدام راس پایین‌تر است. آن راس را بدست آورید و جد هم ارتفاع
متناظرش با راس دیگر را به دست آورید. سپس پدر هر دو راس را حساب کنید.
اگر مساوی بودند که ما جد مشترک را پیدا کرده‌ایم و در غیر این صورت با دو راس جدیدی که پیدا کردیم
کار را ادامه می‌دهیم. چون حداکثر دو برابر لاگ رئوس درخت یال سبک در مسیر وجود خواهد داشت
این الگوریتم پیچیدگی زمانی
<span class="math notranslate nohighlight">\(O(n+q*lg(n))\)</span>
دارد.</p>
</div>
</div>


			        </div>
			    </div>

                            <div class="row-fluid">
			        <div class="col-lg-12">
				    

        
            <div id="body-btn">
                
                    
                    <a href="1.html" style="float:right;" title="شرح مساله" accesskey="p"><i class="fa fa-chevron-right"></i>&nbsp; قبلی</a>
                    
                    
                    <a href="3.html" style="float:left;" title="tarjan offline algorithm" accesskey="n">بعدی &nbsp;<i class="fa fa-chevron-left"></i></a>
                    
                
            </div>
        
			        </div>
			    </div>
                            
                        </div>
                </div>
            </div>
            <span class="back-to-top">
                <i class="fa fa-arrow-circle-up"></i>
            </span>
        </div>
    </body>
</html>