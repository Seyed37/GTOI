

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="fa" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="fa" > <!--<![endif]-->
<html dir="rtl" lang="fa">
    <head>
        
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">


    
         <title>مولفه‌های قویا همبند &mdash; نظریه گراف‌ها برای المپیاد کامپیوتر</title>
    




    

    <link rel="stylesheet" type=text/css href="/_static/main.css">



<link rel="stylesheet" type=text/css href="../../_static/font-awesome.min.css">
<link rel="stylesheet" type=text/css href="../../_static/bootstrap.min.css">
<link rel="stylesheet" type=text/css href="../../_static/pygment-solarized-light.css">


    <link rel="stylesheet" type=text/css href="../../_static/minoo-rtl.css">

        <link rel="index" title="فهرست" href="../../genindex.html" />
        <link rel="search" title="جستجو" href="../../search.html" />
        <link rel="top" title="نظریه گراف‌ها برای المپیاد کامپیوتر" href="../../index.html" />
        <link rel="up" title="گراف جهت‌دار" href="index.html" />
        <link rel="next" title="بازی‌ها و گراف جهت‌دار" href="5.html" />
        <link rel="prev" title="گراف جهت‌دار بدون دور" href="3.html" />



    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>

    
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/translations.js"></script>
        <script type="text/javascript" src="../../_static/searchtools.js"></script>


<script type="text/javascript" src="../../_static/minoo.js"></script>
<script type="text/javascript" src="../../_static/modernizr.min.js"></script>
    </head>
    <body>
        <div id="page">
            <div id="wrapper-page-sidebar">
                

<div id="page-sidebar">
<div id="sidebar-top">
    <div id="sidebar-top-image">
        <span style="background-image: url('../../_static/avatar.png');"></span>
    </div>
    <div id="sidebar-top-links">
        
            <a href=http://git.coderz.ir target="_blank"><i class="fa fa-globe" style="font-size:23px;"></i></a>
        
        
        
        
        
        
            <a href=https://github.com/dariubs/git target="_blank"><i class="fa fa-github-square" style="font-size:23px;"></i></a>
        
        
    </div>
    <div id="sidebar-navigation">
        <span id="navigation-toggle"><i class="fa  fa-angle-double-left " id="sidebar-toggle-icon" style="font-size: 27px;"></i></span>
        <span id="navigation-search">
                <form action="../../search.html" method="get">
                    <input id="input-search" type="text" name="q"  placeholder="جستجو">
                    <input type="hidden" name="check_keywords" value="yes" />
                    <input type="hidden" name="area" value="default" />
                </form>
        </span>
    </div>
    <div id="sidebar-top-title">
        <a href="../../index.html">نظریه گراف‌ها برای المپیاد کامپیوتر</a>
    </div>
</div>

<div id="wrapper-sidebar-bottom">
<div id="sidebar-bottom">
    <div id="sidebar-bottom-list">
        
        
            <div id="tree-toc">
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../1/index.html">تعاریف اولیه</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../1/1.html">مقدمات و پیاده سازی گراف</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1/2.html">مدل سازی با گراف</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1/3.html">گشت، گذر، مسیر، اکسترمال</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1/4.html">همبندی، یال برشی و راس برشی</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1/5.html">زیر گراف ها</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1/6.html">گراف دو بخشی</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../2/index.html">درخت ها</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../2/1.html">خاصیت های مقدماتی</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2/2.html">فاصله در درخت و گراف</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2/3.html">مرکز و قطر گراف</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2/4.html">شمردن تعداد درخت ها</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2/5.html">dfs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2/6.html">bfs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2/7.html">الگوریتم پیدا کردن قطر درخت</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2/8.html">الگوریتم های راس و یال برشی</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2/9.html">کارگاه پرورش ایده</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">گراف جهت‌دار</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="1.html">تعاریف</a></li>
<li class="toctree-l2"><a class="reference internal" href="2.html">تورنومنت</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.html">گراف جهت‌دار بدون دور</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">مولفه‌های قویا همبند</a></li>
<li class="toctree-l2"><a class="reference internal" href="5.html">بازی‌ها و گراف جهت‌دار</a></li>
<li class="toctree-l2"><a class="reference internal" href="6.html">الگوریتم مسیر خاکستری</a></li>
<li class="toctree-l2"><a class="reference internal" href="7.html">گراف تابعی و گراف جایگشت</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../4/index.html">تکنیک های اثبات مسائل گراف</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../4/1.html">انتخاب های اکسترمالی</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4/2.html">منقبض کردن</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4/3.html">گراف و جادو</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../5/index.html">تور اویلری و دور همیلتونی</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../5/1.html">معرفی</a></li>
<li class="toctree-l2"><a class="reference internal" href="../5/2.html">تور اویلری در گراف جهت دار و بی جهت</a></li>
<li class="toctree-l2"><a class="reference internal" href="../5/3.html">De Bruijn sequence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../5/4.html">قضیه های وجودی دور همیلتونی</a></li>
<li class="toctree-l2"><a class="reference internal" href="../5/5.html">الگوریتم های نمایی پیدا کردن دور و مسیر همیلتونی</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../6/index.html">الگوریتم های کوتاه ترین مسیر</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../6/1.html">بلمن فورد</a></li>
<li class="toctree-l2"><a class="reference internal" href="../6/2.html">دکسترا</a></li>
<li class="toctree-l2"><a class="reference internal" href="../6/3.html">فلوید وارشال</a></li>
<li class="toctree-l2"><a class="reference internal" href="../6/4.html">پیدا کردن دور منفی در گراف</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../7/index.html">ماتریس ها</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../7/1.html">ماتریس مجاورت</a></li>
<li class="toctree-l2"><a class="reference internal" href="../7/2.html">تعداد گشت ها به طول n</a></li>
<li class="toctree-l2"><a class="reference internal" href="../7/3.html">به دست آوردن توابع بازگشتی به کمک گراف و ماتریس</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../8/index.html">داده ساختار های درختی</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../8/1.html">BST</a></li>
<li class="toctree-l2"><a class="reference internal" href="../8/2.html">heap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../8/3.html">DSU</a></li>
<li class="toctree-l2"><a class="reference internal" href="../8/4.html">Segment tree</a></li>
<li class="toctree-l2"><a class="reference internal" href="../8/5.html">trie</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../9/index.html">MST</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../9/1.html">Kruskal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../9/2.html">Prim</a></li>
<li class="toctree-l2"><a class="reference internal" href="../9/3.html">Buvrika</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../10/index.html">Lca</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../10/1.html">شرح مساله</a></li>
<li class="toctree-l2"><a class="reference internal" href="../10/2.html">راه حل O(n+q*lg(n)) به کمک جداسازی سبک-سنگین</a></li>
<li class="toctree-l2"><a class="reference internal" href="../10/3.html">الگوریتم برون‌خط تارجان</a></li>
<li class="toctree-l2"><a class="reference internal" href="../10/4.html">ارتباط LCA و RMQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../10/5.html">راه خطی برای LCA</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../11/index.html">الگوریتم های پیشرفته درخت</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../11/1.html">سنتروید</a></li>
<li class="toctree-l2"><a class="reference internal" href="../11/2.html">گونی</a></li>
<li class="toctree-l2"><a class="reference internal" href="../11/3.html">اچ ال دی</a></li>
<li class="toctree-l2"><a class="reference internal" href="../11/4.html">هافمن کدینگ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../11/5.html">هش درخت</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../12/index.html">همبندی</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../12/1.html">برش ها و همبندی</a></li>
<li class="toctree-l2"><a class="reference internal" href="../12/2.html">گراف k همبند</a></li>
<li class="toctree-l2"><a class="reference internal" href="../12/3.html">برش کمینه و جریان بیشینه</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../13/index.html">تطابق</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../13/1.html">آشنایی</a></li>
<li class="toctree-l2"><a class="reference internal" href="../13/2.html">تطابق در گراف دوبخشی</a></li>
<li class="toctree-l2"><a class="reference internal" href="../13/3.html">قضایا ی مینماکس</a></li>
<li class="toctree-l2"><a class="reference internal" href="../13/4.html">کاربرد ها</a></li>
<li class="toctree-l2"><a class="reference internal" href="../13/5.html">جریان بیشینه و تطابق</a></li>
<li class="toctree-l2"><a class="reference internal" href="../13/6.html">Poset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../13/7.html">تطابق در گراف های عام</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../14/index.html">مباحث ویژه</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../14/1.html">گراف مسطح</a></li>
<li class="toctree-l2"><a class="reference internal" href="../14/2.html">دنباله درجه ای</a></li>
<li class="toctree-l2"><a class="reference internal" href="../14/3.html">رنگ آمیزی</a></li>
<li class="toctree-l2"><a class="reference internal" href="../14/4.html">یک ریختی</a></li>
<li class="toctree-l2"><a class="reference internal" href="../14/5.html">Random Walk</a></li>
<li class="toctree-l2"><a class="reference internal" href="../14/6.html">اعداد رمزی</a></li>
<li class="toctree-l2"><a class="reference internal" href="../14/7.html">چند جمله ای گراف</a></li>
<li class="toctree-l2"><a class="reference internal" href="../14/8.html">مجموعه مستقل و خوشه</a></li>
<li class="toctree-l2"><a class="reference internal" href="../14/9.html">2sat</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/index.html">ضمیمه</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../appendix/1.html">چگونه از این کتاب استفاده کنیم؟</a></li>
<li class="toctree-l2"><a class="reference internal" href="../appendix/2.html">آشنایی با الگوریتم ها و پیچیدگی</a></li>
</ul>
</li>
</ul>

            </div>
        
   </div>
   <div id="sidebar-bottom-versions">
      

   </div>
</div>
</div>
</div>
            </div>
            <div id="page-body">
                <div class="container-fluid">
                        <div id="body-content" style="max-width: 800px">

                            <div class="row-fluid">
			        <div class="col-lg-12">
				    

<div id="body-top">
    
    
        <a href="../../index.html"><i class="fa fa-folder-o"></i>&nbsp; فهرست</a>&nbsp;
        <a><i class="fa  fa-angle-left"></i></a>&nbsp;
        <a><i class="fa fa-folder-open-o"></i>&nbsp; مولفه‌های قویا همبند</a>
    
    
        <a style="float: left; padding-right: 20px;" href="/problems/" id="problems-link"><i class="fa fa-question on fa-circle"></i>&nbsp;سوالات</a>
        
            <a href="../../_sources/book/3/4.rst.txt" rel="nofollow" id="top-src" target="_blank"><i class="fa fa-code"></i>&nbsp; سورس</a>
        
    
</div>
			        </div>
			    </div>
                            
                            <div class="row-fluid">
			        <div class="col-lg-12">
				    
  <div class="section" id="id1">
<h1>مولفه‌های قویا همبند<a class="headerlink" href="#id1" title="لینک ثابت به این سر مقاله">¶</a></h1>
<div class="section" id="id2">
<h2><strong>تعریف 3.4.1 (جفت راس قویا همبند)</strong><a class="headerlink" href="#id2" title="لینک ثابت به این سر مقاله">¶</a></h2>
<p>در گراف جهت‌­دار به جفت راس

قویا همبند گوییم اگر و تنها اگر مسیری از

به

و مسیری از

به

وجود داشته باشد.</p>
<p>به عنوان مثال در شکل 1، راس­‌های 2 و 4 یک جفت راس قویا همبند هستند.</p>
</div>
<div class="section" id="id3">
<h2><strong>تعریف 3.4.2 (گراف قویا همبند)</strong><a class="headerlink" href="#id3" title="لینک ثابت به این سر مقاله">¶</a></h2>
<p>گراف قویا همبند، گراف جهت­‌داری است که هر جفت راس آن قویا همبند باشند (شکل 1).</p>
<div class="figure align-left">
<a class="reference internal image-reference" href="../../_images/scc_1.png"><img alt="اگه اینترنت یارو آشغال باشه این میاد" src="../../_images/scc_1.png" style="width: 50%;" /></a>
</div>
</div>
<div class="section" id="strongly-connected-component-scc">
<h2><strong>تعریف 3.4.3 (مولفه قویا همبند (strongly connected component یا به اختصار scc))</strong><a class="headerlink" href="#strongly-connected-component-scc" title="لینک ثابت به این سر مقاله">¶</a></h2>
<p>یک مولفه قویا همبند در گراف جهت­‌دار

، زیرمجموعه­‌ای از رئوس

می­‌باشند که در زیرگراف القایی آن­‌ها تشکیل یک گراف قویا همبند را دهد و همچنین ماکسیمال باشد، یعنی نتوان راس دیگری به آن اضافه کرد.</p>
</div>
<div class="section" id="id4">
<h2><strong>لم 3.4.4</strong><a class="headerlink" href="#id4" title="لینک ثابت به این سر مقاله">¶</a></h2>
<p><strong>صورت لم:</strong> هر راس

در گراف جهت­‌دار

، تنها در یک مولفه قویا همبند یکتا قرار دارد.</p>
<p><strong>اثبات:</strong> از برهان خلف استفاده می­‌کنیم. فرض کنید که

در دو مولفه قویا همبند

و

قرار دارد و

راسی در

باشد که در

قرار ندارد. چون

و

در یک مولفه قویا همبند قرار دارند، در نتیجه از هر راسی در

می­‌توان با مسیری به

آمد و سپس با مسیری به

رفت و همچنین با مسیری از

به

آمد و با مسیری به هر راس دلخواه در

رفت. پس درنتیجه می­‌توان راس

را به مولفه

اضافه کرد که این با ماکسیمال بودن

در تناقض است. از تناقض حاصل درستی حکم نتیجه می‌­شود.</p>
</div>
<div class="section" id="id5">
<h2><strong>نتیجه 3.4.5</strong><a class="headerlink" href="#id5" title="لینک ثابت به این سر مقاله">¶</a></h2>
<p>می­‌توان هر گراف جهت‌­دار

را به مولفه‌­های قویا همبند افراز کرد. شکل 2 گراف جهت­‌داری را نمایش می­‌دهد که مولفه‌­های قویا همبند آن مشخص شده­‌اند.</p>
<div class="figure align-left">
<a class="reference internal image-reference" href="../../_images/scc_2.png"><img alt="اگه اینترنت یارو آشغال باشه این میاد" src="../../_images/scc_2.png" style="width: 50%;" /></a>
</div>
</div>
<div class="section" id="id6">
<h2><strong>تعریف 3.4.6 (گراف معکوس)</strong><a class="headerlink" href="#id6" title="لینک ثابت به این سر مقاله">¶</a></h2>
<p>گراف معکوس

، گرافی است که از معکوس کردن جهت یال‌های گراف

بدست می‌آید. توجه کنید یک گراف قویا همبند است اگر و تنها اگر معکوس آن نیز قویا همبند باشد.</p>
<div class="section" id="id7">
<h3>بدون دور بودن مولفه‌­های قویا همبند<a class="headerlink" href="#id7" title="لینک ثابت به این سر مقاله">¶</a></h3>
</div>
</div>
<div class="section" id="id8">
<h2><strong>تعریف 3.4.7 (گراف فشرده شده مولفه­های قویا همبند)</strong><a class="headerlink" href="#id8" title="لینک ثابت به این سر مقاله">¶</a></h2>
<p>فرض کنید

، یک گراف جهت­‌دار دلخواه باشد و گراف جهت­‌دار

گرافی باشد که هر راس آن متناظر با یک مولفه قویا همبند در

است و هر مولفه قویا همبند در

به دقیقا یک راس در

متناظر شود. اگر

راسی در

باشد، مولفه قویا همبند متناظر با راس

در

را با

نمایش می‌­دهیم. اگر

و

دو راس از

باشند، به ازای هر یال جهت‌­دار از رئوس

به رئوس

، یالی جهت­‌دار از

به

قرار دارد و همچنین هر یالی که از

به

است، متناظر با یالی از رئوس

به رئوس

می­‌باشد. در این صورت به

، یک گراف فشرده شده مولفه‌­های قویا همبند

می‌­گوییم.</p>
</div>
<div class="section" id="id9">
<h2><strong>قضیه 3.4.8</strong><a class="headerlink" href="#id9" title="لینک ثابت به این سر مقاله">¶</a></h2>
<p><strong>صورت قضیه:</strong> هر گراف فشرده شده مولفه­‌های قویا همبند، دور ندارد.</p>
<p><strong>اثبات:</strong> فرض کنید

یک گراف جهت‌­دار دلخواه است و

، گراف فشرده شده مولفه­‌های قویا همبند

باشد.از برهان خلف استفاده می‌­کنیم. فرض کنید

دور داشته باشد و دو راس مانند

و

از

در یک دور قرار داشته باشند. چون از هر راس در یک مولفه قویا همبند به هر راس آن مولفه مسیر هست، پس در نتیجه می‌­توان از هر راس در

به هر راس در

رفت و همچنین از هر راس در

به هر راس در

مسیری جهت­‌دار وجود دارد (چرا؟) که یعنی رئوس

و

باید در یک مولفه قویا همبند قرار بگیرند که این با فرض ماکسیمال بودن مولفه‌­های قویا همبند در تناقض است. پس در نتیجه

دور ندارد و حکم اثبات می‌­شود.</p>
</div>
<div class="section" id="id10">
<h2><strong>نتیجه 3.4.9</strong><a class="headerlink" href="#id10" title="لینک ثابت به این سر مقاله">¶</a></h2>
<p>طبق قضیه 3.3.2، می­‌توان رئوس هر گراف فشرده شده مولفه­‌های قویا همبند را توپولوژیک سورت کرد. پس در نتیجه می‌­توان مولفه­‌های قویا همبند هر گراف جهت‌داری را به صورت توپولوژیک سورت کنار هم قرار دهیم، یعنی به این صورت که جهت همه یال­‌هایی که بین دو مولفه متفاوت باشند، به یک سمت باشند (شکل 3).</p>
<div class="figure align-left">
<a class="reference internal image-reference" href="../../_images/scc_3.png"><img alt="اگه اینترنت یارو آشغال باشه این میاد" src="../../_images/scc_3.png" style="width: 50%;" /></a>
</div>
<div class="section" id="id11">
<h3>پیدا کردن مولفه­‌های قویا همبند<a class="headerlink" href="#id11" title="لینک ثابت به این سر مقاله">¶</a></h3>
<p>حال قصد داریم الگوریتمی با پیچیدگی زمانی مناسب برای پیدا کردن مولفه­‌های قویا همبند یک گراف ارائه دهیم.</p>
</div>
</div>
<div class="section" id="id12">
<h2><strong>الگوریتم کساراجو</strong><a class="headerlink" href="#id12" title="لینک ثابت به این سر مقاله">¶</a></h2>
<p><strong>شرح:</strong> ابتدا روی کل گراف

می­‌زنیم و هربار هنگام خروج از هر راس آن را در یک پشته می‌­اندازیم (توجه کنید هر چه از راسی دیرتر خارج شویم، در پشته بالاتر قرار می‌گیرد). حال گراف معکوس را درنظر می­‌گیریم و در هر مرحله از بین تمام راس‌های دیده نشده، راسی که در پشته بالاتر از بقیه قرار دارد (مانند

) را برداشته و از آن در گراف معکوس،

می‌­زنیم و

و تمام راس­‌هایی که دیده می‌­شوند (از طریق

زدن از راس

) را در یک مولفه جدید قرار می‌­دهیم و این کار را تا پیدا شدن تمام مولفه­‌های قویا همبند ادامه می‌­دهیم. توجه کنید که هنگام

زدن بر روی گراف معکوس، زمانی که راسی دیده می‌­شود، آن را به عنوان دیده شده علامت زده و در سری‌­های بعد از آن

نمی­‌زنیم و یا به آن وارد نمی‌­شویم.</p>
<p><strong>اثبات درستی:</strong> برای اثبات این الگوریتم, ابتدا به لم زیر که مشابه آن را در بخش قبل داشتیم توجه کنید.</p>
<p>تعریف می‌کنیم

به معنای زمان تمام شدن پیمایش برای راس

. به عبارتی داریم موقعیت یک راس را در پشته مشخص می‌کنیم(هر چه

بیشتر باشد, راس در پشته در جایگاه پایین‌تری قرار می‌گیرد).</p>
<p><strong>لم ۱:</strong> اگر

و به عبارتی راس

در پشته, بالا تر از راس

باشد, و همچنین مسیری از

به

باشد, آنگاه مسیری از

به

نیز وجود دارد.</p>
<p><strong>برهان لم۱:</strong> از برهان خلف استفاده می‌کنیم. فرض کنید مسیری از

به

است و  هیچ مسیری از

به

نباشد.</p>
<p>آنگاه چون ما در ابتدا راس

را در پیمایش دیده‌ایم(چرا؟) و مسیری از

به

نیست, پس هیچگاه راس

را پیمایش نمیکنیم, مگر اینکه پیمایش راس

تمام شود. از طرفی اگر پیمایش راس

تمام شود و هنوز راس

را ندیده باشیم, نتیجه می‌شود که اول

به پشته اضافه می‌شود و بعد

به عبارتی

که این خلاف فرض است. پس لم ثابت شد!</p>
<p>حال توجه داشته باشید در هنگام پیمایش گراف معکوس, روی معکوس یال‌ها حرکت می‌کنیم. یعنی عضو بالای پشته که راس

باشد را برمی‌داریم و روی همه راس‌هایی مثل

که از

به

مسیر هست پیمایش می‌کنیم. در این‌صورت طبق لم۱، راس

هم به راس

مسیر دارد!</p>
<p>پس

و همه رئوسی که در پیمایش گراف معکوس از

دیده شدند در یک مولفه قرار می‌گیرند!</p>
<p>از طرفی هیچ راس دیگری در این مولفه نیست. زیرا در غیر این صورت اگر راس دیگری در این مولفه قرار می‌گرفت، باید حداقل یک مسیر به

می‌داشت و جزو ر‌ئوس دیده‌شده از

شمرده می‌شد.</p>
</div>
<div class="section" id="id13">
<h2><strong>پیچیدگی الگوریتم</strong><a class="headerlink" href="#id13" title="لینک ثابت به این سر مقاله">¶</a></h2>
<p>در الگوریتم بالا صرفا ۲ بار از

استفاده کردیم, در نتیجه پیچیدگی الگوریتم برابر با

است که

به ترتیب تعداد راس‌ها و یال‌ها می‌باشند.</p>
</div>
<div class="section" id="id14">
<h2><strong>لم 3.4.10</strong><a class="headerlink" href="#id14" title="لینک ثابت به این سر مقاله">¶</a></h2>
<p><strong>صورت لم:</strong> الگوریتم کساراجو، مولفه‌های قویا همبند را به ترتیب توپولوژیک سورت آن‌ها آن‌ها پیدا می‌کند.</p>
<p><strong>اثبات:</strong> به استقرا بر روی تعداد مولفه‌های قویا همبند حکم را ثابت می‌کنیم. به ازای یک مولفه که درستی حکم بدیهی است. حال اگر فرض بر درستی حکم به ازای

مولفه باشد، حکم را به ازای

مولفه ثابت می‌کنیم. اگر به مولفه اولی که در الگوریتم پیدا می‌کنیم (مانند

) از مولفه دیگری مانند

یالی وارد شود، در این صورت در گراف معکوس، از

به

یال هست و چون در الگوریتم،

بعد از

پیدا می‌شود، پس در هنگام پیمایش

در گراف معکوس، باید تعدادی از راس‌های

دیده شوند و در

قرار گیرند در صورتی که مولفه‌ها نمی‌توانند اشتراک داشته باشند. پس در نتیجه مولفه اولی که پیدا می‌کنیم یالی از سمت مولفه‌های دیگر به آن وارد نمی‌شود و اولین مولفه در توپولوژیک سورت می‌باشد. حال طبق فرض استقرا باقی مولفه‌ها نیز به ترتیب توپولوژیک سورت پیدا می‌شوند (چرا؟) و حکم اثبات می‌شود.</p>
</div>
<div class="section" id="id15">
<h2><strong>پیاده‌سازی الگوریتم</strong><a class="headerlink" href="#id15" title="لینک ثابت به این سر مقاله">¶</a></h2>
<p>توجه کنید انتها کد، مولفه ها را به ترتیب توپولوژیک سورت آن‌ها خروجی می‌دهیم.</p>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp"></span>

<span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>

<span class="k">const</span> <span class="kt">int</span> <span class="n">MX</span> <span class="o">=</span> <span class="mf">5e5</span> <span class="o">+</span> <span class="mi">5</span><span class="p">;</span>

<span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">;</span> <span class="c1">/// tedad ras ha va yal ha</span>
<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">gr</span><span class="p">[</span><span class="n">MX</span><span class="p">],</span> <span class="n">back_gr</span><span class="p">[</span><span class="n">MX</span><span class="p">],</span> <span class="n">comp</span><span class="p">[</span><span class="n">MX</span><span class="p">];</span> <span class="c1">/// vector mojaverat, vector mojaverat(yal haie barax), moalefe haie ghavian hamband</span>
<span class="n">stack</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">sk</span><span class="p">;</span> <span class="c1">/// moratab kardan ras ha barhasbe tamam shodan dfs</span>
<span class="kt">bool</span> <span class="n">mark</span><span class="p">[</span><span class="n">MX</span><span class="p">];</span> <span class="c1">/// array mark baraie check kardane dide shodan ras ha</span>

<span class="kt">void</span> <span class="nf">dfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">v</span><span class="p">){</span>  <span class="c1">/// dfs mamoli!</span>
    <span class="n">mark</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="nl">u</span><span class="p">:</span> <span class="n">gr</span><span class="p">[</span><span class="n">v</span><span class="p">]){</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">mark</span><span class="p">[</span><span class="n">u</span><span class="p">])</span>
            <span class="n">dfs</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">sk</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">back_dfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">v</span><span class="p">,</span> <span class="kt">int</span> <span class="n">cnt</span><span class="p">){</span>  <span class="c1">/// dfs roie yal haie barax!</span>
    <span class="n">mark</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">comp</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="nl">u</span><span class="p">:</span> <span class="n">back_gr</span><span class="p">[</span><span class="n">v</span><span class="p">]){</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">mark</span><span class="p">[</span><span class="n">u</span><span class="p">])</span>
            <span class="n">back_dfs</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">cnt</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="n">m</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">m</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="kt">int</span> <span class="n">v</span><span class="p">,</span> <span class="n">u</span><span class="p">;</span>
        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">v</span> <span class="o">&gt;&gt;</span> <span class="n">u</span><span class="p">;</span> <span class="c1">/// shomare ras ha 0-based hast.</span>
        <span class="n">gr</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">u</span><span class="p">);</span> <span class="c1">/// in vector yal ha ra zakhire mikonad</span>
        <span class="n">back_gr</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">v</span><span class="p">);</span> <span class="c1">/// in vector barax yal ha ra zakhire mikonad</span>
    <span class="p">}</span>

    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">mark</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">dfs</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="n">fill</span><span class="p">(</span><span class="n">mark</span><span class="p">,</span> <span class="n">mark</span> <span class="o">+</span> <span class="n">n</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span> <span class="c1">/// chon mikhahim dfs jadid bezanim, mark ra 0 mikonim.</span>

    <span class="kt">int</span> <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">sk</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">){</span> <span class="c1">/// stack kheili kond ast. dar inja serfan baraie dark behtar stack estefade shode. behtar ast az vector estefade konid.</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">mark</span><span class="p">[</span><span class="n">sk</span><span class="p">.</span><span class="n">top</span><span class="p">()]){</span>
            <span class="n">back_dfs</span><span class="p">(</span><span class="n">sk</span><span class="p">.</span><span class="n">top</span><span class="p">(),</span> <span class="n">cnt</span><span class="p">);</span> <span class="c1">/// yek moalefe ra peida mikonim</span>
            <span class="n">cnt</span><span class="o">++</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">sk</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
    <span class="p">}</span>


    <span class="c1">/// moalefe hara be tartib topo sort eshan chap mikonim</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">cnt</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;: &quot;</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="k">auto</span> <span class="nl">v</span><span class="p">:</span> <span class="n">comp</span><span class="p">[</span><span class="n">i</span><span class="p">]){</span>
            <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">v</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39; &#39;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>


			        </div>
			    </div>

                            <div class="row-fluid">
			        <div class="col-lg-12">
				    

        
            <div id="body-btn">
                
                    
                    <a href="3.html" style="float:right;" title="گراف جهت‌دار بدون دور" accesskey="p"><i class="fa fa-chevron-right"></i>&nbsp; قبلی</a>
                    
                    
                    <a href="5.html" style="float:left;" title="بازی‌ها و گراف جهت‌دار" accesskey="n">بعدی &nbsp;<i class="fa fa-chevron-left"></i></a>
                    
                
            </div>
        


        <div id="body-footer">
            <div>
                <a href="https://shaazzz.ir/"><img src="/_static/shaazzz_logo.png"></a>
            </div>
            <div id="text">
                <p>
                    این کتاب توسط 
                    <a href="/contributors">
                    مشارکت کنندگان شاززز
                    </a>
                    به وجود آمده است.
                </p>
                <p>
                    این کتاب عمومی است و تحت پروانه cc-by-sa در دسترس است.
                </p>
                    <p style="font-size: 13px;">
                        آخرین به روز رسانی در مهٔ 10, 2020.
                    </p>
                <p style="font-size: 13px;">
                    
                        ساخته شده به وسیله <a href="http://sphinx-doc.org/">Sphinx</a> (1.6.7) و <a href="https://github.com/saeiddrv/SphinxMinooTheme">تم مینو</a> (Beta 0.9.7).
                    
                </p>
            </div>
            <div>
                <a href="https://pdcommunity.ir/license/cc-by-sa/">
                    <img src="/_static/cc-by-sa.png">
                </a>
            </div>
        </div>
			        </div>
			    </div>
                            
                        </div>
                </div>
            </div>
            <span class="back-to-top">
                <i class="fa fa-arrow-circle-up"></i>
            </span>
        </div>
    </body>
</html>